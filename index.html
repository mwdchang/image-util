<!DOCTYPE html>
<html>
<head>
<script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
<style>
html {
  font-family: 'Roboto';font-size: 18px;
  background-image: radial-gradient(circle, #ffc9e8, #f6cbf0, #ebcef7, #dfd1fc, #d3d4ff, #cadaff, #c3dfff, #bfe4ff, #c0ecff, #c5f3ff, #ccf9fd, #d6fffc);
  height: 100%;
}

body {
  margin: 1.25rem;
}

main {
  display: grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap: 0.5rem;
}

canvas {
  background: #eee;
  border: 1px solid #555;
  border-radius: 8px;

  /* Cap the size */
  max-width: 315px;
  max-height: 315px;

  /* Center inside grid area */
  width: 100%;
  height: 100%;

  /* Optional: maintain square ratio */
  aspect-ratio: 1 / 1;

  /* Visual */
  display: flex;
  justify-content: center;
  align-items: center;

  /* opacity: 0.95; */
}

/* Humanist-style anchor tag */
a {
  color: #3a4a8f;
  text-decoration: none;
  font-weight: 500;
  letter-spacing: 0.15px;
  transition: 
    color 0.25s ease,
    text-shadow 0.25s ease,
    background-color 0.25s ease;
}

a:hover {
  color: #2b3a78;
  text-shadow: 0 1px 0 rgba(0,0,0,0.08);
}

a:active {
  color: #1c2755;
  text-shadow: none;
}
</style>
</head>
<body>
  <h3> Image filters: </h3>
  <p style="color: #888; font-size: 14px">
      Top-left most is the base/original image, followed by a series of image filters. Refresh the page to generate new base image.
      <br>
      <a href="https://github.com/mwdchang/image-util">See source here</a>
  </p>
  <h3 id="load-blocker" style="color:#888"> Working ... this takes a few seconds. <h3> 
  <main>
  </main>
</body>
<script type="module">
import * as ImageUtil from "./dist/index.js"

const mainElem = document.body.querySelector('main');


const img = await ImageUtil.loadImage('https://picsum.photos/300', { width: 300, height: 300 });
mainElem.append(ImageUtil.createCanvas(img));

// Dodge burn effect
const burn = ImageUtil.dodgeFilter(
  ImageUtil.invertFilter(ImageUtil.uniformBlur(ImageUtil.greyScaleFilter(img), 8)),
  ImageUtil.greyScaleFilter(img)
);
const painterly = ImageUtil.painterlyFilter(img, 4, 10);
const slic = ImageUtil.SLIC(img, 12, 18, 4, 80);
const sepia = ImageUtil.sepiaFilter(img);

const options = {
  levelSteps: 3,
  lineThickness: 1.5,
  lineLength: 40,
  lineAlpha: 0.3,
  lineDensity: 0.2,
  darkeningFactor: 0.1,
  lightness: 4,
  edgeAmount: 0.1,
  edgeBlurAmount: 3,
  greyScale: false
};
const sketch = ImageUtil.sketchTransform(structuredClone(img), options);

const emboss = ImageUtil.embossFilter(img);

let fishEye= ImageUtil.fishEyeFilter(img, 120, 80, 180, 0.0055);
fishEye= ImageUtil.fishEyeFilter(fishEye, 220, 180, 140, 0.0055);

const nightVision = ImageUtil.uniformBlur(
  ImageUtil.glowFilter(
    ImageUtil.nightVisionFilter(img)
  ), 6
);
const polaroid = ImageUtil.polaroidFilter(img);
const halftone = ImageUtil.halftoneFilter(img, {
  kernel: 9,
  shiftXAmt: 0,
  shiftXStride: 0
});

const swirl = ImageUtil.swirlFilter(img, 150, 150, 200, 180 * Math.PI / 180.0);
const kaleidoscope = ImageUtil.kaleidoscopeFilter(img, 90, 150, 6);

const filters = [
  burn,
  painterly,
  slic,
  sepia,
  sketch,
  emboss,
  fishEye,
  nightVision,
  polaroid,
  halftone,
  swirl,
  kaleidoscope
];

for (const filter of _.shuffle(filters).slice(0, 7)) {
  mainElem.append(ImageUtil.createCanvas(filter));
}

const blocker = document.querySelector('#load-blocker');
if (blocker) {
  blocker.remove();
}
</script>
</html>
